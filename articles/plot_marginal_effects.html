<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Plotting Marginal Effects of Regression Models • sjPlot</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plotting Marginal Effects of Regression Models">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sjPlot</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.8.16.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-regression-tables" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Regression Tables</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-regression-tables">
<li><a class="dropdown-item" href="../articles/tab_model_estimates.html">Classical Regression Models as HTML Table</a></li>
    <li><a class="dropdown-item" href="../articles/tab_mixed.html">Mixed Models as HTML Table</a></li>
    <li><a class="dropdown-item" href="../articles/tab_bayes.html">Bayesian Models as HTML Table</a></li>
    <li><a class="dropdown-item" href="../articles/tab_model_robust.html">Robust Estimation of Standard Errors, Confidence Intervals and p-values</a></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-regression-plots" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Regression Plots</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-regression-plots">
<li><a class="dropdown-item" href="../articles/plot_model_estimates.html">Plotting Regression Coefficients</a></li>
    <li><a class="dropdown-item" href="../articles/plot_marginal_effects.html">Plotting Marginal Effects</a></li>
    <li><a class="dropdown-item" href="../articles/plot_interactions.html">Plotting Marginal Effects of Interactions</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-plot-and-table-customization" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Plot and Table Customization</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-plot-and-table-customization">
<li><a class="dropdown-item" href="../articles/blackwhitefigures.html">Creating Black and White Figures</a></li>
    <li><a class="dropdown-item" href="../articles/custplot.html">Customize Plot Appearance</a></li>
    <li><a class="dropdown-item" href="../articles/table_css.html">Customize Table Appearance</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-other-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Other Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-other-articles">
<li><a class="dropdown-item" href="../articles/sjtitemanalysis.html">Item Analysis of a Scale or an Index</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/strengejacke/sjPlot/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Plotting Marginal Effects of Regression Models</h1>
                        <h4 data-toc-skip class="author">Daniel
Lüdecke</h4>
            
            <h4 data-toc-skip class="date">2024-08-28</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/strengejacke/sjPlot/blob/master/vignettes/plot_marginal_effects.Rmd" class="external-link"><code>vignettes/plot_marginal_effects.Rmd</code></a></small>
      <div class="d-none name"><code>plot_marginal_effects.Rmd</code></div>
    </div>

    
    
<!--
vignette: >
  %\VignetteIndexEntry{Plotting Marginal Effects of Regression Models}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
-->
<p>This document describes how to plot marginal effects of various
regression models, using the <code><a href="../reference/plot_model.html">plot_model()</a></code> function.
<code><a href="../reference/plot_model.html">plot_model()</a></code> is a generic plot-function, which accepts many
model-objects, like <code>lm</code>, <code>glm</code>, <code>lme</code>,
<code>lmerMod</code> etc.</p>
<p><code><a href="../reference/plot_model.html">plot_model()</a></code> allows to create various plot tyes, which
can be defined via the <code>type</code>-argument. The default is
<code>type = "fe"</code>, which means that fixed effects (model
coefficients) are plotted. To plot marginal effects, call
<code><a href="../reference/plot_model.html">plot_model()</a></code> with:</p>
<ul>
<li>
<code>type = "pred"</code> to plot predicted values (marginal
effects) for specific model terms.</li>
<li>
<code>type = "eff"</code>, which is similar to
<code>type = "pred"</code>, however, discrete predictors are held
constant at their proportions (not reference level). It internally calls
via .</li>
<li>
<code>type = "emm"</code>, which is similar to
<code>type = "eff"</code>. It internally calls via .</li>
<li>
<code>type = "int"</code> to plot marginal effects of interaction
terms.</li>
</ul>
<p>To plot marginal effects of regression models, at least one model
term needs to be specified for which the effects are computed. It is
also possible to compute marginal effects for model terms, grouped by
the levels of another model’s predictor. The function also allows
plotting marginal effects for two- or three-way-interactions, however,
this is shown in a different vignette.</p>
<p><code><a href="../reference/plot_model.html">plot_model()</a></code> supports <a href="https://cran.r-project.org/package=sjlabelled" class="external-link">labelled data</a>
and automatically uses variable and value labels to annotate the plot.
This works with most regression modelling functions.</p>
<p><em><strong>Note:</strong> For marginal effects plots,
<strong>sjPlot</strong> calls functions from the <a href="https://strengejacke.github.io/ggeffects/" class="external-link"><strong>ggeffects-package</strong></a>.
If you need more flexibility when creating marginal effects plots,
consider directly using the <strong>ggeffects</strong>-package.</em></p>
<div class="section level2">
<h2 id="marginal-effects">Marginal effects<a class="anchor" aria-label="anchor" href="#marginal-effects"></a>
</h2>
<p><code>plot_model(type = "pred")</code> computes predicted values for
all possible levels and values from a model’s predictors. In the
simplest case, a fitted model is passed as first argument, followed by
the <code>type</code> argument and the term in question as
<code>terms</code> argument:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://strengejacke.github.io/sjPlot/">sjPlot</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">efc</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="../reference/sjPlot-themes.html">theme_sjplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">barthtot</span> <span class="op">~</span> <span class="va">c12hour</span> <span class="op">+</span> <span class="va">neg_c_7</span> <span class="op">+</span> <span class="va">c161sex</span> <span class="op">+</span> <span class="va">c172code</span>, data <span class="op">=</span> <span class="va">efc</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"pred"</span>, terms <span class="op">=</span> <span class="st">"c12hour"</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_marginal_effects_files/figure-html/unnamed-chunk-1-1.png" width="672"></p>
<p>The plot shows the predicted values for the response at each value
from the term <em>c12hour</em>.</p>
<div class="section level3">
<h3 id="marginal-effects-for-different-groups">Marginal effects for different groups<a class="anchor" aria-label="anchor" href="#marginal-effects-for-different-groups"></a>
</h3>
<p>The <code>terms</code>-argument accepts up to three model terms,
where the second and third term indicate grouping levels. This allows
predictions for the term in question at different levels for other model
terms:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"pred"</span>, terms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"c12hour"</span>, <span class="st">"c172code"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_marginal_effects_files/figure-html/unnamed-chunk-2-1.png" width="672"></p>
<p>A second grouping structure can be defined, which will create a plot
with multiple panels in grid layout:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"pred"</span>, terms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"c12hour"</span>, <span class="st">"c172code"</span>, <span class="st">"c161sex"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_marginal_effects_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="marginal-effects-at-specific-values-or-levels">Marginal effects at specific values or levels<a class="anchor" aria-label="anchor" href="#marginal-effects-at-specific-values-or-levels"></a>
</h3>
<p>The <code>terms</code>-argument not only defines the model terms of
interest, but each model term <em>that defines the grouping
structure</em> can be limited to certain values. This allows to compute
and plot marginal effects for terms at specific values only. To define
these values, put them in square brackets directly after the term name:
<code>terms = c("c12hour [30, 50, 80]", "c172code [1,3]")</code></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"pred"</span>, terms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"c12hour [30, 50, 80]"</span>, <span class="st">"c172code [1,3]"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_marginal_effects_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
<p>Note that in the above plot, although the values 30, 50 and 80 only
are selected from <em>c12hour</em>, the continuous scale automatically
adds panel grids every 5 units along the x-axis.</p>
<p>Defining own values is especially useful when variables are, for
instance, log-transformed. <code><a href="../reference/plot_model.html">plot_model()</a></code> then typically only
uses the range of the log-transformed variable, which is in most cases
not what we want. In such situation, specify the range in the
<code>terms</code>-argument.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="va">mpg_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">hp</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># x-values and predictions based on the log(hp)-values</span></span>
<span><span class="fu"><a href="../reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">mpg_model</span>, type <span class="op">=</span> <span class="st">"pred"</span>, terms <span class="op">=</span> <span class="st">"hp"</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_marginal_effects_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># x-values and predictions based on hp-values from 50 to 150</span></span>
<span><span class="fu"><a href="../reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">mpg_model</span>, type <span class="op">=</span> <span class="st">"pred"</span>, terms <span class="op">=</span> <span class="st">"hp [50:150]"</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_marginal_effects_files/figure-html/unnamed-chunk-5-2.png" width="672"></p>
<p>The brackets in the <code>terms</code>-argument also accept the name
of a valid function, to (back-)transform predicted valued. In this
example, an alternative would be to specify that values should be
exponentiated, which is indicated by <code>[exp]</code> in the
<code>terms</code>-argument:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># x-values and predictions based on exponentiated hp-values</span></span>
<span><span class="fu"><a href="../reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">mpg_model</span>, type <span class="op">=</span> <span class="st">"pred"</span>, terms <span class="op">=</span> <span class="st">"hp [exp]"</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_marginal_effects_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="polynomial-terms-and-splines">Polynomial terms and splines<a class="anchor" aria-label="anchor" href="#polynomial-terms-and-splines"></a>
</h3>
<p>The function also works for models with polynomial terms or splines.
Following code reproduces the plot from <code><a href="https://rdrr.io/r/splines/bs.html" class="external-link">?splines::bs</a></code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">splines</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">women</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/splines/bs.html" class="external-link">bs</a></span><span class="op">(</span><span class="va">height</span>, df <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">women</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">fm1</span>, type <span class="op">=</span> <span class="st">"pred"</span>, terms <span class="op">=</span> <span class="st">"height"</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_marginal_effects_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="different-constant-values-for-factors">Different constant values for factors<a class="anchor" aria-label="anchor" href="#different-constant-values-for-factors"></a>
</h3>
<p>Model predictions are based on all possible combinations of the model
terms, which are - roughly speaking - created using
<code><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid()</a></code>. For the terms in question, all values are
used for combinations. All other model predictors that are <em>not</em>
specified in the <code>terms</code>-argument, are held constant (which
is achieved with <code>sjstats::typical_value()</code>). By default,
continuous variables are set to their mean, while factors are set to
their reference level.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">efc</span><span class="op">)</span></span>
<span><span class="va">efc</span><span class="op">$</span><span class="va">c172code</span> <span class="op">&lt;-</span> <span class="fu">sjlabelled</span><span class="fu">::</span><span class="fu"><a href="https://strengejacke.github.io/sjlabelled/reference/as_factor.html" class="external-link">as_factor</a></span><span class="op">(</span><span class="va">efc</span><span class="op">$</span><span class="va">c172code</span><span class="op">)</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">neg_c_7</span> <span class="op">~</span> <span class="va">c12hour</span> <span class="op">+</span> <span class="va">c172code</span>, data <span class="op">=</span> <span class="va">efc</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># reference category is used for "c172code", i.e. c172code</span></span>
<span><span class="co"># used the first level as value for predictions</span></span>
<span><span class="fu"><a href="../reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"pred"</span>, terms <span class="op">=</span> <span class="st">"c12hour"</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_marginal_effects_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<p>However, one may want to set factors to their <em>proportions</em>
instead of reference level. E.g., a factor <em>gender</em> with value 0
for female and value 1 for male persons, would be set to <code>0</code>
when marginal effects are computed with <code>type = "pred"</code>. But
if 40% of the sample are female persons, another possibility to hold
this factor constant is to use the value <code>.4</code> (reflecting the
proportion of 40%). If this is required, use <code>type = "eff"</code>,
which internally does not call <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> to compute
marginal effects, but rather <code><a href="https://rdrr.io/pkg/effects/man/effect.html" class="external-link">effects::effect()</a></code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># proportion is used for "c172code", i.e. it is set to</span></span>
<span><span class="co"># mean(sjlabelled::as_numeric(efc$c172code), na.rm = T),</span></span>
<span><span class="co"># which is about 1.9715</span></span>
<span><span class="fu"><a href="../reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"eff"</span>, terms <span class="op">=</span> <span class="st">"c12hour"</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_marginal_effects_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="interaction-terms">Interaction terms<a class="anchor" aria-label="anchor" href="#interaction-terms"></a>
</h2>
<p>Plotting interaction terms are described in a <a href="plot_interactions.html">separate vignette</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/strengejacke" class="external-link">Daniel Lüdecke</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
