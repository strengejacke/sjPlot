<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot polynomials for (generalized) linear regression — sjp.poly • sjPlot</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot polynomials for (generalized) linear regression — sjp.poly"><meta name="description" content="This function plots a scatter plot of a term poly.term
               against a response variable x and adds - depending on
               the amount of numeric values in poly.degree - multiple
               polynomial curves. A loess-smoothed line can be added to see
               which of the polynomial curves fits best to the data."><meta property="og:description" content="This function plots a scatter plot of a term poly.term
               against a response variable x and adds - depending on
               the amount of numeric values in poly.degree - multiple
               polynomial curves. A loess-smoothed line can be added to see
               which of the polynomial curves fits best to the data."><meta property="og:image" content="https://strengejacke.github.io/sjPlot/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sjPlot</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.8.16.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-regression-tables" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Regression Tables</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-regression-tables"><li><a class="dropdown-item" href="../articles/tab_model_estimates.html">Classical Regression Models as HTML Table</a></li>
    <li><a class="dropdown-item" href="../articles/tab_mixed.html">Mixed Models as HTML Table</a></li>
    <li><a class="dropdown-item" href="../articles/tab_bayes.html">Bayesian Models as HTML Table</a></li>
    <li><a class="dropdown-item" href="../articles/tab_model_robust.html">Robust Estimation of Standard Errors, Confidence Intervals and p-values</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-regression-plots" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Regression Plots</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-regression-plots"><li><a class="dropdown-item" href="../articles/plot_model_estimates.html">Plotting Regression Coefficients</a></li>
    <li><a class="dropdown-item" href="../articles/plot_marginal_effects.html">Plotting Marginal Effects</a></li>
    <li><a class="dropdown-item" href="../articles/plot_interactions.html">Plotting Marginal Effects of Interactions</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-plot-and-table-customization" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Plot and Table Customization</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-plot-and-table-customization"><li><a class="dropdown-item" href="../articles/blackwhitefigures.html">Creating Black and White Figures</a></li>
    <li><a class="dropdown-item" href="../articles/custplot.html">Customize Plot Appearance</a></li>
    <li><a class="dropdown-item" href="../articles/table_css.html">Customize Table Appearance</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-other-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Other Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-other-articles"><li><a class="dropdown-item" href="../articles/sjtitemanalysis.html">Item Analysis of a Scale or an Index</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/strengejacke/sjPlot/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Plot polynomials for (generalized) linear regression</h1>
      <small class="dont-index">Source: <a href="https://github.com/strengejacke/sjPlot/blob/master/R/sjPlotPolynomials.R" class="external-link"><code>R/sjPlotPolynomials.R</code></a></small>
      <div class="d-none name"><code>sjp.poly.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function plots a scatter plot of a term <code>poly.term</code>
               against a response variable <code>x</code> and adds - depending on
               the amount of numeric values in <code>poly.degree</code> - multiple
               polynomial curves. A loess-smoothed line can be added to see
               which of the polynomial curves fits best to the data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sjp.poly</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">poly.term</span>,</span>
<span>  <span class="va">poly.degree</span>,</span>
<span>  poly.scale <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  fun <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  axis.title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  geom.colors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  geom.size <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  show.loess <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  show.loess.ci <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  show.p <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  show.scatter <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  point.alpha <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  point.color <span class="op">=</span> <span class="st">"#404040"</span>,</span>
<span>  loess.color <span class="op">=</span> <span class="st">"#808080"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A vector, representing the response variable of a linear (mixed) model; or
a linear (mixed) model as returned by <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code> or <code><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></code>.</p></dd>


<dt id="arg-poly-term">poly.term<a class="anchor" aria-label="anchor" href="#arg-poly-term"></a></dt>
<dd><p>If <code>x</code> is a vector, <code>poly.term</code> should also be a vector, representing
the polynomial term (independent variabl) in the model; if <code>x</code> is a
fitted model, <code>poly.term</code> should be the polynomial term's name as character string.
See 'Examples'.</p></dd>


<dt id="arg-poly-degree">poly.degree<a class="anchor" aria-label="anchor" href="#arg-poly-degree"></a></dt>
<dd><p>Numeric, or numeric vector, indicating the degree of the polynomial.
If <code>poly.degree</code> is a numeric vector, multiple polynomial curves for
each degree are plotted. See 'Examples'.</p></dd>


<dt id="arg-poly-scale">poly.scale<a class="anchor" aria-label="anchor" href="#arg-poly-scale"></a></dt>
<dd><p>Logical, if <code>TRUE</code>, <code>poly.term</code> will be scaled before
linear regression is computed. Default is <code>FALSE</code>. Scaling the polynomial
term may have an impact on the resulting p-values.</p></dd>


<dt id="arg-fun">fun<a class="anchor" aria-label="anchor" href="#arg-fun"></a></dt>
<dd><p>Linear function when modelling polynomial terms. Use <code>fun = "lm"</code>
for linear models, or <code>fun = "glm"</code> for generalized linear models.
When <code>x</code> is not a vector, but a fitted model object, the function
is detected automatically. If <code>x</code> is a vector, <code>fun</code> defaults
to <code>"lm"</code>.</p></dd>


<dt id="arg-axis-title">axis.title<a class="anchor" aria-label="anchor" href="#arg-axis-title"></a></dt>
<dd><p>Character vector of length one or two (depending on the
plot function and type), used as title(s) for the x and y axis. If not
specified, a default labelling  is chosen. <strong>Note:</strong> Some plot types
may not support this argument sufficiently. In such cases, use the returned
ggplot-object and add axis titles manually with
<code><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></code>. Use <code>axis.title = ""</code> to remove axis
titles.</p></dd>


<dt id="arg-geom-colors">geom.colors<a class="anchor" aria-label="anchor" href="#arg-geom-colors"></a></dt>
<dd><p>user defined color for geoms. See 'Details' in <code><a href="plot_grpfrq.html">plot_grpfrq</a></code>.</p></dd>


<dt id="arg-geom-size">geom.size<a class="anchor" aria-label="anchor" href="#arg-geom-size"></a></dt>
<dd><p>size resp. width of the geoms (bar width, line thickness or point size,
depending on plot type and function). Note that bar and bin widths mostly
need smaller values than dot sizes.</p></dd>


<dt id="arg-show-loess">show.loess<a class="anchor" aria-label="anchor" href="#arg-show-loess"></a></dt>
<dd><p>Logical, if <code>TRUE</code>, an additional loess-smoothed line is plotted.</p></dd>


<dt id="arg-show-loess-ci">show.loess.ci<a class="anchor" aria-label="anchor" href="#arg-show-loess-ci"></a></dt>
<dd><p>Logical, if <code>TRUE</code>, a confidence region for the loess-smoothed line
will be plotted.</p></dd>


<dt id="arg-show-p">show.p<a class="anchor" aria-label="anchor" href="#arg-show-p"></a></dt>
<dd><p>Logical, if <code>TRUE</code> (default), p-values for polynomial terms are
printed to the console.</p></dd>


<dt id="arg-show-scatter">show.scatter<a class="anchor" aria-label="anchor" href="#arg-show-scatter"></a></dt>
<dd><p>Logical, if TRUE (default), adds a scatter plot of data
points to the plot.</p></dd>


<dt id="arg-point-alpha">point.alpha<a class="anchor" aria-label="anchor" href="#arg-point-alpha"></a></dt>
<dd><p>Alpha value of point-geoms in the scatter plots. Only
applies, if <code>show.scatter = TRUE</code>.</p></dd>


<dt id="arg-point-color">point.color<a class="anchor" aria-label="anchor" href="#arg-point-color"></a></dt>
<dd><p>Color of of point-geoms in the scatter plots. Only applies,
if <code>show.scatter = TRUE.</code></p></dd>


<dt id="arg-loess-color">loess.color<a class="anchor" aria-label="anchor" href="#arg-loess-color"></a></dt>
<dd><p>Color of the loess-smoothed line. Only applies, if <code>show.loess = TRUE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A ggplot-object.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For each polynomial degree, a simple linear regression on <code>x</code> (resp.
           the extracted response, if <code>x</code> is a fitted model) is performed,
           where only the polynomial term <code>poly.term</code> is included as independent variable.
           Thus, <code>lm(y ~ x + I(x^2) + ... + I(x^i))</code> is repeatedly computed
           for all values in <code>poly.degree</code>, and the predicted values of
           the reponse are plotted against the raw values of <code>poly.term</code>.
           If <code>x</code> is a fitted model, other covariates are ignored when
           finding the best fitting polynomial. <br><br>
           This function evaluates raw polynomials, <em>not orthogonal</em> polynomials.
           Polynomials are computed using the <code><a href="https://rdrr.io/r/stats/poly.html" class="external-link">poly</a></code> function,
           with argument <code>raw = TRUE</code>. <br><br>
           To find out which polynomial degree fits best to the data, a loess-smoothed
           line (in dark grey) can be added (with <code>show.loess = TRUE</code>). The polynomial curves
           that comes closest to the loess-smoothed line should be the best
           fit to the data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://strengejacke.github.io/sjmisc/" class="external-link">sjmisc</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">efc</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># linear fit. loess-smoothed line indicates a more</span></span></span>
<span class="r-in"><span><span class="co"># or less cubic curve</span></span></span>
<span class="r-in"><span><span class="fu">sjp.poly</span><span class="op">(</span><span class="va">efc</span><span class="op">$</span><span class="va">c160age</span>, <span class="va">efc</span><span class="op">$</span><span class="va">quol_5</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Polynomial degrees: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p(x^1): 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> `geom_smooth()` using formula = 'y ~ x'</span>
<span class="r-plt img"><img src="sjp.poly-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># quadratic fit</span></span></span>
<span class="r-in"><span><span class="fu">sjp.poly</span><span class="op">(</span><span class="va">efc</span><span class="op">$</span><span class="va">c160age</span>, <span class="va">efc</span><span class="op">$</span><span class="va">quol_5</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Polynomial degrees: 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p(x^1): 0.078</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p(x^2): 0.533</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> `geom_smooth()` using formula = 'y ~ x'</span>
<span class="r-plt img"><img src="sjp.poly-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># linear to cubic fit</span></span></span>
<span class="r-in"><span><span class="fu">sjp.poly</span><span class="op">(</span><span class="va">efc</span><span class="op">$</span><span class="va">c160age</span>, <span class="va">efc</span><span class="op">$</span><span class="va">quol_5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, show.scatter <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Polynomial degrees: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p(x^1): 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Polynomial degrees: 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p(x^1): 0.078</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p(x^2): 0.533</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Polynomial degrees: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p(x^1): 0.012</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p(x^2): 0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p(x^3): 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Polynomial degrees: 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p(x^1): 0.777</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p(x^2): 0.913</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p(x^3): 0.505</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p(x^4): 0.254</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> `geom_smooth()` using formula = 'y ~ x'</span>
<span class="r-plt img"><img src="sjp.poly-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit sample model</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">tot_sc_e</span> <span class="op">~</span> <span class="va">c12hour</span> <span class="op">+</span> <span class="va">e17age</span> <span class="op">+</span> <span class="va">e42dep</span>, data <span class="op">=</span> <span class="va">efc</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># inspect relationship between predictors and response</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"slope"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> `geom_smooth()` using formula = 'y ~ x'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> `geom_smooth()` using formula = 'y ~ x'</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>pseudoinverse used at 4.015</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>neighborhood radius 2.015</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>reciprocal condition number  1.5462e-16</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>There are other near singularities as well. 1</span>
<span class="r-plt img"><img src="sjp.poly-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># "e17age" does not seem to be linear correlated to response</span></span></span>
<span class="r-in"><span><span class="co"># try to find appropiate polynomial. Grey line (loess smoothed)</span></span></span>
<span class="r-in"><span><span class="co"># indicates best fit. Looks like x^4 has the best fit,</span></span></span>
<span class="r-in"><span><span class="co"># however, only x^3 has significant p-values.</span></span></span>
<span class="r-in"><span><span class="fu">sjp.poly</span><span class="op">(</span><span class="va">fit</span>, <span class="st">"e17age"</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">4</span>, show.scatter <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Polynomial degrees: 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p(x^1): 0.734</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p(x^2): 0.721</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Polynomial degrees: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p(x^1): 0.010</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p(x^2): 0.011</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p(x^3): 0.011</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Polynomial degrees: 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p(x^1): 0.234</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p(x^2): 0.267</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p(x^3): 0.303</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p(x^4): 0.343</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> `geom_smooth()` using formula = 'y ~ x'</span>
<span class="r-plt img"><img src="sjp.poly-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># fit new model</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">tot_sc_e</span> <span class="op">~</span> <span class="va">c12hour</span> <span class="op">+</span> <span class="va">e42dep</span> <span class="op">+</span> <span class="va">e17age</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">e17age</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">e17age</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          data <span class="op">=</span> <span class="va">efc</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># plot marginal effects of polynomial term</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"pred"</span>, terms <span class="op">=</span> <span class="st">"e17age"</span><span class="op">)</span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/strengejacke" class="external-link">Daniel Lüdecke</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

